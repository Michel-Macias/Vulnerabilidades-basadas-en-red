# Práctica de Laboratorio: Omisión de NAC (Conceptual)

---

### ⚠️ Advertencia Legal y Ética

**Este laboratorio demuestra una técnica de suplantación de identidad de red (MAC Spoofing) con fines puramente educativos. La ejecución de este tipo de ataques contra sistemas o redes que no son de tu propiedad o para los que no tienes permiso explícito es ilegal y una violación de la privacidad.**

**Toda la información y los comandos aquí presentados deben ser utilizados únicamente en un entorno de laboratorio controlado y aislado. El autor y el asistente no se hacen responsables del mal uso de esta información.**

---

**Objetivo:** Demostrar cómo un atacante puede evadir un control de acceso a la red (NAC) básico que utiliza un filtro de direcciones MAC, mediante la técnica de **MAC Spoofing**.

**Escenario Conceptual:**
Imagina una red corporativa que, como medida de seguridad simple, solo permite el acceso a la red a los dispositivos cuya dirección MAC está en una "lista blanca". Nuestro objetivo como atacantes es conseguir que nuestro dispositivo no autorizado (Kali Linux) obtenga acceso a esa red.

**Máquinas Requeridas:**
*   Una VM con Kali Linux (atacante).
*   Una VM víctima (Windows 8.1), que simularemos que es un "dispositivo autorizado".

**Herramientas:**
*   `macchanger`: Una utilidad de Linux para ver y cambiar la dirección MAC de una interfaz de red.

---

## Parte 1: Reconocimiento (Encontrar una MAC Autorizada)

El primer paso para el atacante es descubrir la dirección MAC de un dispositivo que sí tenga permiso para acceder a la red.

### Paso 1: Identificar la MAC de la Víctima

1.  **En la máquina Windows 8.1 (nuestro dispositivo "autorizado")**, abre un `cmd` y ejecuta el siguiente comando para ver su configuración de red:
    ```
    ipconfig /all
    ```
2.  Busca el adaptador de red principal (normalmente "Adaptador de Ethernet") y apunta el valor de la **"Dirección física"**. Esta es la dirección MAC autorizada. Por ejemplo: `00-1A-2B-3C-4D-5E`.

En un escenario real, un atacante podría obtener esta MAC escuchando pasivamente el tráfico de la red, sin necesidad de tener acceso al dispositivo.

---

## Parte 2: Ejecución del MAC Spoofing en Kali Linux

Ahora, en nuestra máquina Kali, vamos a suplantar la dirección MAC que acabamos de descubrir.

### Paso 1: Ver la Dirección MAC Actual

Primero, identifica el nombre de tu interfaz de red (normalmente `eth0`) y mira tu dirección MAC actual.

```bash
# Muestra la configuración de la interfaz eth0
ip addr show eth0
```
Verás tu MAC actual en la línea que empieza por `link/ether`.

### Paso 2: Cambiar la Dirección MAC

Usaremos la herramienta `macchanger`. Para que el cambio sea efectivo, primero debemos deshabilitar la interfaz de red, luego cambiar la MAC y finalmente volver a habilitarla.

> **Nota:** Reemplaza `[MAC_AUTORIZADA]` por la dirección física que obtuviste de la máquina Windows.

```bash
# 1. Deshabilitar la interfaz de red
sudo ifconfig eth0 down

# 2. Cambiar la dirección MAC
sudo macchanger -m [MAC_AUTORIZADA] eth0

# 3. Volver a habilitar la interfaz de red
sudo ifconfig eth0 up
```

**Salida esperada de `macchanger`:**
```
[+] Current MAC:   XX:XX:XX:XX:XX:XX (Original MAC)
[+] Permanent MAC: XX:XX:XX:XX:XX:XX (MAC de fábrica)
[+] New MAC:       00:1A:2B:3C:4D:5E (La MAC que hemos suplantado)
```

### Paso 3: Verificación

Para confirmar que el cambio se ha realizado, vuelve a ejecutar el comando para ver la configuración de la interfaz.

```bash
ip addr show eth0
```
Ahora, en la línea `link/ether`, deberías ver la nueva dirección MAC suplantada.

---

## Conclusión Conceptual

En este punto, si nuestra máquina Kali estuviera conectada a la red corporativa hipotética, el sistema NAC vería nuestra petición de conexión. Al inspeccionar nuestra dirección MAC, vería `00-1A-2B-3C-4D-5E`, la cual está en su lista blanca. Como resultado, el NAC nos concedería acceso completo a la red, creyendo que somos el dispositivo legítimo.

Este laboratorio demuestra por qué un filtro de direcciones MAC por sí solo es una medida de seguridad **muy débil e insuficiente**. Un atacante con acceso físico a la red puede eludirla en cuestión de minutos. Las soluciones NAC modernas deben combinar múltiples factores de autenticación (como 802.1X, certificados digitales y evaluación de postura del dispositivo) para ser efectivas.